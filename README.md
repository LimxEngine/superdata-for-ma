# SuperData åè®®è§„èŒƒ v2.0

## æ–‡æ¡£ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|------|------|
| åè®®åç§° | SuperData Protocol |
| ç‰ˆæœ¬ | 2.0.0 |
| å‘å¸ƒæ—¥æœŸ | 2025-12-01 |
| ä½œè€… | Yunsio SuperStage Team |
| çŠ¶æ€ | âœ… æ­£å¼å‘å¸ƒ |

---

## 1. æ¦‚è¿°

### 1.1 åè®®ç›®çš„

SuperData åè®®æ˜¯ä¸€ä¸ªè·¨å¼•æ“ã€è·¨å¹³å°çš„å®æ—¶æ•°æ®å…±äº«åè®®ï¼Œä¸“ä¸ºèˆå°ç¯å…·æ•°æ®åŒæ­¥è®¾è®¡ã€‚è¯¥åè®®å…è®¸ä¸åŒè½¯ä»¶å¹³å°ï¼ˆUnityã€Unreal Engineã€Vectorworksã€GrandMA ç­‰ï¼‰ä¹‹é—´å®æ—¶å…±äº«ç¯å…·é…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š

- ç¯å…·ä½ç½®å’Œæ—‹è½¬
- DMX åœ°å€é…ç½®ï¼ˆUniverseã€Addressã€FixtureIDï¼‰
- ç¯å…·ç±»å‹ä¿¡æ¯
- è‡ªå®šä¹‰å±æ€§

### 1.2 æ¶æ„æ¨¡å¼ï¼šç¾¤èŠæ¨¡å¼

**v2.0 é‡‡ç”¨"ç¾¤èŠ"æ¶æ„**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SuperDataServer.exe (ä¸­å¤®è·¯ç”±å™¨)                â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚              Session Manager (ä¼šè¯ç®¡ç†)              â”‚   â”‚
â”‚   â”‚         ç®¡ç†æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œç¼“å­˜å„ç«¯æ•°æ®              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                â”‚
â”‚                     TCP localhost:5966                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                 â”‚                 â”‚
        Unity               UE               VW
       (å®¢æˆ·ç«¯)           (å®¢æˆ·ç«¯)          (å®¢æˆ·ç«¯)
      "æˆ‘çš„ç¯å…·æ•°æ®"      "æˆ‘çš„ç¯å…·æ•°æ®"     "æˆ‘çš„ç¯å…·æ•°æ®"
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š

1. **ç‹¬ç«‹æœåŠ¡è¿›ç¨‹** - SuperDataServer.exe ä½œä¸ºä¸­å¤®è·¯ç”±å™¨ï¼Œæ— éœ€å„ç«¯é‡å¤å®ç°åè®®å±‚
2. **ç¾¤èŠæ¨¡å¼** - å„å®¢æˆ·ç«¯åŠ å…¥åŒä¸€ä¸ª"ç¾¤"ï¼Œå…±äº«å„è‡ªçš„ç¯å…·æ•°æ®
3. **é€‰æ‹©æ€§å¯¼å…¥** - å®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©ä»ç¾¤å†…ä»»æ„å…¶ä»–å®¢æˆ·ç«¯å¯¼å…¥æ•°æ®
4. **è‡ªåŠ¨ç”Ÿå‘½å‘¨æœŸ** - ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥æ—¶å¯åŠ¨æœåŠ¡ï¼Œæœ€åä¸€ä¸ªæ–­å¼€æ—¶æœåŠ¡è‡ªåŠ¨é€€å‡º

**ä½¿ç”¨åœºæ™¯ç¤ºä¾‹**ï¼š

```
1. Unity ç”¨æˆ·æ‰“å¼€è¿æ¥é¢æ¿ â†’ è‡ªåŠ¨å¯åŠ¨ Server â†’ Unity åŠ å…¥ç¾¤èŠ
2. UE ç”¨æˆ·æ‰“å¼€è¿æ¥é¢æ¿ â†’ å‘ç° Server å·²è¿è¡Œ â†’ UE åŠ å…¥ç¾¤èŠ
3. VW ç”¨æˆ·æ‰“å¼€è¿æ¥é¢æ¿ â†’ VW åŠ å…¥ç¾¤èŠ
4. UE ç”¨æˆ·æƒ³å¯¼å…¥ç¯å…· â†’ çœ‹åˆ°ç¾¤å†…æœ‰ Unity å’Œ VW â†’ é€‰æ‹©ä» Unity å¯¼å…¥
5. æ‰€æœ‰ç”¨æˆ·å…³é—­è¿æ¥ â†’ Server è‡ªåŠ¨é€€å‡º
```

### 1.3 è®¾è®¡åŸåˆ™

1. **ç®€æ´æ€§** - ä½¿ç”¨ JSON ä½œä¸ºè´Ÿè½½æ ¼å¼ï¼Œä¾¿äºè°ƒè¯•å’Œè·¨è¯­è¨€å®ç°
2. **å¯é æ€§** - TCP ç”¨äºæ•°æ®ä¼ è¾“
3. **å…¼å®¹æ€§** - ç»Ÿä¸€åæ ‡ç³»æ ‡å‡†ï¼Œå„ç«¯è‡ªè¡Œè½¬æ¢
4. **æ‰©å±•æ€§** - é¢„ç•™è‡ªå®šä¹‰å±æ€§å­—æ®µï¼Œæ”¯æŒæœªæ¥æ‰©å±•
5. **é›¶é…ç½®** - å®¢æˆ·ç«¯åªéœ€è°ƒç”¨ exeï¼Œæ— éœ€æ‰‹åŠ¨é…ç½® IP/ç«¯å£

### 1.4 æ”¯æŒå¹³å°

| å¹³å°ä»£ç  | å¹³å°åç§° | çŠ¶æ€ |
|----------|----------|------|
| 1 | Unity | âœ… å·²å®ç° |
| 2 | Unreal Engine | âœ… å·²å®ç° |
| 3 | Vectorworks | ğŸ“‹ è®¡åˆ’ä¸­ |
| 4 | GrandMA2 | âœ… å·²å®ç° |
| 255 | Custom | é¢„ç•™ |

### 1.5 å®¢æˆ·ç«¯ç¤ºä¾‹

æä¾› 8 ç§ç¼–ç¨‹è¯­è¨€çš„å®Œæ•´å®¢æˆ·ç«¯åº“å®ç°ï¼š

| è¯­è¨€ | ç›®å½• | ç‰¹æ€§ |
|------|------|------|
| Python | `Examples/Python/` | asyncio å¼‚æ­¥ã€ç±»å‹æç¤º |
| JavaScript | `Examples/JavaScript/` | Node.jsã€äº‹ä»¶é©±åŠ¨ |
| TypeScript | `Examples/TypeScript/` | å¼ºç±»å‹ã€å®Œæ•´ç±»å‹å®šä¹‰ |
| C# | `Examples/CSharp/` | .NET 8ã€async/await |
| C++ | `Examples/Cpp/` | Asio å¼‚æ­¥ã€è·¨å¹³å° |
| Rust | `Examples/Rust/` | Tokio å¼‚æ­¥ã€å®‰å…¨å†…å­˜ |
| Java | `Examples/Java/` | Maven æ„å»ºã€Gson JSON |
| Lua | `Examples/Lua/` | LuaSocketã€GrandMA å…¼å®¹ |

æ‰€æœ‰å®¢æˆ·ç«¯åº“éƒ½å†…ç½®ï¼š
- âœ… è‡ªåŠ¨å¯åŠ¨æœåŠ¡å™¨ï¼ˆä»æ³¨å†Œè¡¨è¯»å–è·¯å¾„ï¼‰
- âœ… ç¦ç”¨ç³»ç»Ÿä»£ç†
- âœ… TCP ç²˜åŒ…å¤„ç†
- âœ… å¿ƒè·³ä¿æ´»

---

## 2. ç½‘ç»œå±‚è§„èŒƒ

### 2.1 ç«¯å£å®šä¹‰

| ç”¨é€” | åè®® | ç«¯å£ | è¯´æ˜ |
|------|------|------|------|
| æ•°æ®ä¼ è¾“ | TCP | 5966 | å¯é ä¼ è¾“ |

> **v2.0 å˜æ›´**ï¼šç§»é™¤ UDP 5965 æœåŠ¡å‘ç°ç«¯å£ã€‚é‡‡ç”¨ç‹¬ç«‹æœåŠ¡è¿›ç¨‹æ¨¡å¼ï¼Œå®¢æˆ·ç«¯ç›´æ¥è¿æ¥ `localhost:5966`ã€‚

### 2.2 æ•°æ®åŒ…æ ¼å¼

æ‰€æœ‰æ•°æ®åŒ…é‡‡ç”¨ç»Ÿä¸€çš„äºŒè¿›åˆ¶å¤´ + JSON è´Ÿè½½æ ¼å¼ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ•°æ®åŒ…ç»“æ„ (Packet)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åç§»é‡  â”‚  é•¿åº¦  â”‚  å­—æ®µå          â”‚  ç±»å‹      â”‚  è¯´æ˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  0       â”‚  4     â”‚  Magic           â”‚  char[4]   â”‚  "SPDT"  â”‚
â”‚  4       â”‚  2     â”‚  Version         â”‚  uint16    â”‚  åè®®ç‰ˆæœ¬ â”‚
â”‚  6       â”‚  2     â”‚  PacketType      â”‚  uint16    â”‚  åŒ…ç±»å‹   â”‚
â”‚  8       â”‚  4     â”‚  SequenceNumber  â”‚  uint32    â”‚  åºåˆ—å·   â”‚
â”‚  12      â”‚  8     â”‚  Timestamp       â”‚  int64     â”‚  æ—¶é—´æˆ³   â”‚
â”‚  20      â”‚  4     â”‚  PayloadLength   â”‚  uint32    â”‚  è´Ÿè½½é•¿åº¦ â”‚
â”‚  24      â”‚  N     â”‚  Payload         â”‚  byte[N]   â”‚  JSONæ•°æ® â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2.1 å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | å­—èŠ‚åº | è¯´æ˜ |
|------|------|--------|------|
| Magic | char[4] | - | å›ºå®šå€¼ "SPDT" (0x53, 0x50, 0x44, 0x54) |
| Version | uint16 | Little Endian | å½“å‰ç‰ˆæœ¬: 1 |
| PacketType | uint16 | Little Endian | è§ [3. æ•°æ®åŒ…ç±»å‹](#3-æ•°æ®åŒ…ç±»å‹) |
| SequenceNumber | uint32 | Little Endian | é€’å¢åºåˆ—å·ï¼Œç”¨äºè¿½è¸ª |
| Timestamp | int64 | Little Endian | Unix æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ |
| PayloadLength | uint32 | Little Endian | JSON è´Ÿè½½çš„å­—èŠ‚é•¿åº¦ |
| Payload | byte[] | UTF-8 | JSON æ ¼å¼çš„è´Ÿè½½æ•°æ® |

#### 2.2.2 å¤´éƒ¨å¤§å°

**å›ºå®šå¤´éƒ¨å¤§å°: 24 å­—èŠ‚**

### 2.3 å­—èŠ‚åº

æ‰€æœ‰å¤šå­—èŠ‚æ•´æ•°é‡‡ç”¨ **Little Endianï¼ˆå°ç«¯åºï¼‰** ç¼–ç ã€‚

---

## 3. æ•°æ®åŒ…ç±»å‹

### 3.1 ç±»å‹å®šä¹‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®åŒ…ç±»å‹æšä¸¾                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åˆ†ç±»        â”‚  ä»£ç     â”‚  åç§°              â”‚  æ–¹å‘     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¿æ¥ç®¡ç†    â”‚  0x0010  â”‚  Connect           â”‚  C â†’ S   â”‚
â”‚              â”‚  0x0011  â”‚  ConnectAck        â”‚  S â†’ C   â”‚
â”‚              â”‚  0x0012  â”‚  Disconnect        â”‚  C â†” S   â”‚
â”‚              â”‚  0x0013  â”‚  Heartbeat         â”‚  C â†” S   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å®¢æˆ·ç«¯ç®¡ç†  â”‚  0x0014  â”‚  ClientJoined      â”‚  S â†’ C   â”‚
â”‚              â”‚  0x0015  â”‚  ClientLeft        â”‚  S â†’ C   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®åŒæ­¥    â”‚  0x0020  â”‚  FixtureListRequestâ”‚  C â†’ S   â”‚
â”‚              â”‚  0x0021  â”‚  FixtureListResponseâ”‚ S â†’ C   â”‚
â”‚              â”‚  0x0022  â”‚  FixtureUpdate     â”‚  C â†’ S   â”‚
â”‚              â”‚  0x0023  â”‚  FixtureFullSync   â”‚  C â†’ S   â”‚
â”‚              â”‚  0x0024  â”‚  FixtureDelete     â”‚  C â†’ S   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é”™è¯¯        â”‚  0xFF00  â”‚  Error             â”‚  S â†’ C   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å›¾ä¾‹: S = Server, C = Client
```

> **v2.0 å˜æ›´**ï¼š
> - ç§»é™¤æœåŠ¡å‘ç°åŒ…ï¼ˆ0x0001-0x0003ï¼‰
> - ç§»é™¤ç±»å‹æ˜ å°„åŒ…ï¼ˆ0x0030-0x0032ï¼‰ï¼Œç±»å‹ç”±å®¢æˆ·ç«¯è‡ªè¡Œç®¡ç†
> - æ–°å¢ ClientJoined/ClientLeftï¼ˆ0x0014-0x0015ï¼‰ç”¨äºç¾¤æˆå‘˜é€šçŸ¥
> - æ–°å¢ FixtureFullSyncï¼ˆ0x0023ï¼‰ç”¨äºå®¢æˆ·ç«¯ä¸ŠæŠ¥å®Œæ•´æ•°æ®
> - ç§»é™¤ FixtureCreate/FixtureSyncCompleteï¼Œç»Ÿä¸€ä½¿ç”¨ FixtureFullSync

### 3.2 è¿æ¥ç®¡ç†åŒ…

#### 3.2.1 Connect (0x0010)

å®¢æˆ·ç«¯è¯·æ±‚åŠ å…¥ç¾¤èŠã€‚

**Payload ç»“æ„**:
```json
{
    "clientId": "550e8400-e29b-41d4-a716-446655440000",
    "clientName": "My UE Project",
    "platform": 2,
    "platformVersion": "5.3",
    "protocolVersion": "2.0.0"
}
```

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| clientId | string | âœ“ | å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆUUIDï¼Œå®¢æˆ·ç«¯ç”Ÿæˆï¼‰ |
| clientName | string | âœ“ | å®¢æˆ·ç«¯æ˜¾ç¤ºåç§°ï¼ˆç”¨æˆ·å¯è‡ªå®šä¹‰ï¼‰ |
| platform | int | âœ“ | å¹³å°ä»£ç ï¼ˆè§1.4ï¼‰ |
| platformVersion | string | âœ“ | å¹³å°ç‰ˆæœ¬å· |
| protocolVersion | string | âœ“ | åè®®ç‰ˆæœ¬ |

#### 3.2.2 ConnectAck (0x0011)

æœåŠ¡ç«¯å“åº”è¿æ¥è¯·æ±‚ï¼Œè¿”å›å½“å‰ç¾¤å†…æ‰€æœ‰æˆå‘˜ã€‚

**Payload ç»“æ„**:
```json
{
    "accepted": true,
    "errorCode": 0,
    "errorMessage": "",
    "clients": [
        {
            "clientId": "...",
            "clientName": "Unity Project",
            "platform": 1,
            "fixtureCount": 42
        },
        {
            "clientId": "...",
            "clientName": "VW Project",
            "platform": 3,
            "fixtureCount": 28
        }
    ]
}
```

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| accepted | bool | æ˜¯å¦æ¥å—è¿æ¥ |
| errorCode | int | é”™è¯¯ä»£ç ï¼ˆè§7.1ï¼‰ |
| errorMessage | string | é”™è¯¯æè¿° |
| clients | array | å½“å‰ç¾¤å†…æ‰€æœ‰å®¢æˆ·ç«¯ï¼ˆä¸å«è‡ªå·±ï¼‰ |

#### 3.2.3 Disconnect (0x0012)

ä¸»åŠ¨æ–­å¼€è¿æ¥é€šçŸ¥ã€‚

**Payload**: `{}`

#### 3.2.4 Heartbeat (0x0013)

å¿ƒè·³ä¿æ´»åŒ…ï¼ŒåŒå‘å‘é€ã€‚

**å‘é€é—´éš”**: 3000ms  
**è¶…æ—¶æ—¶é—´**: 10000msï¼ˆæœªæ”¶åˆ°å¿ƒè·³åˆ™æ–­å¼€ï¼‰

**Payload**: `{}`

---

### 3.3 å®¢æˆ·ç«¯ç®¡ç†åŒ…

#### 3.3.1 ClientJoined (0x0014)

å½“æœ‰æ–°å®¢æˆ·ç«¯åŠ å…¥ç¾¤èŠæ—¶ï¼ŒServer å¹¿æ’­ç»™æ‰€æœ‰å…¶ä»–å®¢æˆ·ç«¯ã€‚

**Payload ç»“æ„**:
```json
{
    "clientId": "550e8400-e29b-41d4-a716-446655440000",
    "clientName": "New UE Project",
    "platform": 2,
    "fixtureCount": 0
}
```

#### 3.3.2 ClientLeft (0x0015)

å½“æœ‰å®¢æˆ·ç«¯ç¦»å¼€ç¾¤èŠæ—¶ï¼ŒServer å¹¿æ’­ç»™æ‰€æœ‰å…¶ä»–å®¢æˆ·ç«¯ã€‚

**Payload ç»“æ„**:
```json
{
    "clientId": "550e8400-e29b-41d4-a716-446655440000"
}
```

---

### 3.4 æ•°æ®åŒæ­¥åŒ…

#### 3.4.1 FixtureListRequest (0x0020)

è¯·æ±‚æŒ‡å®šå®¢æˆ·ç«¯çš„ç¯å…·åˆ—è¡¨ã€‚

**Payload ç»“æ„**:
```json
{
    "sourceClientId": "550e8400-e29b-41d4-a716-446655440000"
}
```

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| sourceClientId | string | âœ“ | è¦è·å–æ•°æ®çš„å®¢æˆ·ç«¯ID |

#### 3.4.2 FixtureListResponse (0x0021)

è¿”å›æŒ‡å®šå®¢æˆ·ç«¯çš„ç¯å…·åˆ—è¡¨ã€‚

**Payload ç»“æ„**:
```json
{
    "sourceClientId": "550e8400-e29b-41d4-a716-446655440000",
    "fixtures": [
        {
            "uuid": "fixture_001",
            "name": "Spot Light 1",
            "fixtureType": "BP_SpotLight",
            "universe": 1,
            "startAddress": 1,
            "fixtureID": 1,
            "position": [0.0, 5.0, 3.0],
            "rotation": [45.0, 0.0, 0.0],
            "scale": [1.0, 1.0, 1.0],
            "channelSpan": 16,
            "customProperties": {
                "manufacturer": "Robe",
                "model": "Robin 600"
            }
        }
    ],
    "totalCount": 42
}
```

#### 3.4.3 FixtureUpdate (0x0022)

å®¢æˆ·ç«¯ä¸ŠæŠ¥ç¯å…·å¢é‡æ›´æ–°ï¼ˆä¿®æ”¹å•ä¸ªç¯å…·ï¼‰ï¼ŒServer æ›´æ–°ç¼“å­˜å¹¶å¹¿æ’­ç»™å…¶ä»–å®¢æˆ·ç«¯ã€‚

**Payload ç»“æ„**:
```json
{
    "uuid": "fixture_001",
    "changes": {
        "position": [1.0, 5.0, 3.0],
        "universe": 2
    }
}
```

> **å¹¿æ’­è¡Œä¸º**ï¼šServer æ”¶åˆ°åä¼šè½¬å‘ç»™ç¾¤å†…æ‰€æœ‰å…¶ä»–å®¢æˆ·ç«¯ï¼Œå…¶ä»–å®¢æˆ·ç«¯å¯æ®æ­¤å®æ—¶æ›´æ–°è§†å›¾ã€‚

#### 3.4.4 FixtureFullSync (0x0023)

å®¢æˆ·ç«¯ä¸ŠæŠ¥å®Œæ•´çš„ç¯å…·åˆ—è¡¨ï¼ˆå…¨é‡åŒæ­¥ï¼‰ã€‚ç”¨äºï¼š
- å®¢æˆ·ç«¯é¦–æ¬¡è¿æ¥åä¸ŠæŠ¥è‡ªå·±çš„æ•°æ®
- å®¢æˆ·ç«¯æ•°æ®å‘ç”Ÿæ‰¹é‡å˜åŒ–æ—¶é‡æ–°åŒæ­¥

**Payload ç»“æ„**:
```json
{
    "fixtures": [
        {
            "uuid": "fixture_001",
            "name": "Spot Light 1",
            "fixtureType": "BP_SpotLight",
            "universe": 1,
            "startAddress": 1,
            "fixtureID": 1,
            "position": [0.0, 5.0, 3.0],
            "rotation": [45.0, 0.0, 0.0],
            "scale": [1.0, 1.0, 1.0],
            "channelSpan": 16,
            "customProperties": {}
        }
    ],
    "totalCount": 42
}
```

> **è¯´æ˜**ï¼šServer æ”¶åˆ°åä¼šå®Œå…¨æ›¿æ¢è¯¥å®¢æˆ·ç«¯çš„ç¼“å­˜æ•°æ®ï¼Œå¹¶æ›´æ–° fixtureCountã€‚

#### 3.4.5 FixtureDelete (0x0024)

å®¢æˆ·ç«¯ä¸ŠæŠ¥åˆ é™¤ç¯å…·ã€‚

**Payload ç»“æ„**:
```json
{
    "uuids": ["fixture_001", "fixture_002"]
}
```

> **å¹¿æ’­è¡Œä¸º**ï¼šServer æ”¶åˆ°åæ›´æ–°ç¼“å­˜å¹¶è½¬å‘ç»™ç¾¤å†…æ‰€æœ‰å…¶ä»–å®¢æˆ·ç«¯ã€‚

---

## 4. æ•°æ®ç»“æ„å®šä¹‰

### 4.1 ç¯å…·æ•°æ® (Fixture)

```json
{
    "uuid": "string",           // å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆå¿…å¡«ï¼Œå®¢æˆ·ç«¯ç”ŸæˆUUIDï¼‰
    "name": "string",           // æ˜¾ç¤ºåç§°ï¼ˆå¿…å¡«ï¼‰
    "fixtureType": "string",    // ç¯å…·ç±»å‹åï¼ˆå¿…å¡«ï¼Œå®¢æˆ·ç«¯è‡ªå®šä¹‰ï¼‰
    "universe": 1,              // DMX Universe (1-256)
    "startAddress": 1,          // DMX Address (1-512)
    "fixtureID": 1,             // ç¯å…·ç¼–å· (1-65535)
    "position": [0, 0, 0],      // ä½ç½® [X, Y, Z] å˜ç±³ï¼ˆæ ‡å‡†åæ ‡ç³»ï¼‰
    "rotation": [0, 0, 0],      // æ—‹è½¬ [X, Y, Z] åº¦ï¼ˆæ¬§æ‹‰è§’ï¼‰
    "scale": [1, 1, 1],         // ç¼©æ”¾ [X, Y, Z]
    "channelSpan": 0,           // DMX é€šé“è·¨åº¦
    "customProperties": {}      // è‡ªå®šä¹‰å±æ€§å­—å…¸
}
```

> **UUID ç”Ÿæˆ**ï¼šç”±å®¢æˆ·ç«¯åœ¨åˆ›å»ºç¯å…·æ—¶ç”Ÿæˆï¼Œæ¨èä½¿ç”¨æ ‡å‡† UUID v4 æ ¼å¼ã€‚

### 4.2 å®¢æˆ·ç«¯ä¿¡æ¯ (ClientInfo)

```json
{
    "clientId": "string",       // å®¢æˆ·ç«¯å”¯ä¸€IDï¼ˆUUIDï¼‰
    "clientName": "string",     // å®¢æˆ·ç«¯æ˜¾ç¤ºåç§°
    "platform": 1,              // å¹³å°ä»£ç 
    "fixtureCount": 0           // å½“å‰ç¯å…·æ•°é‡
}
```

> **v2.0 å˜æ›´**ï¼šç®€åŒ–äº†åŸ ServiceInfo ç»“æ„ï¼Œç§»é™¤äº†ä¸ç‹¬ç«‹æœåŠ¡æ¨¡å¼æ— å…³çš„å­—æ®µã€‚

---

## 5. åæ ‡ç³»è§„èŒƒ

### 5.1 æ ‡å‡†åæ ‡ç³»å®šä¹‰

SuperData åè®®ä½¿ç”¨ **å³æ‰‹åæ ‡ç³»ï¼ŒZè½´å‘ä¸Š** ä½œä¸ºæ ‡å‡†åæ ‡ç³»ï¼Œä¸ MVR/GDTF è¡Œä¸šæ ‡å‡†ä¸€è‡´ã€‚

```
        Z (ä¸Š)
        â”‚
        â”‚
        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€ Y (å‰/Downstage)
       /
      /
     X (å³/Stage Right)
```

| è½´ | æ–¹å‘ | æ­£å€¼å«ä¹‰ | èˆå°æœ¯è¯­ |
|----|------|----------|----------|
| X | å³ | å‘å³ç§»åŠ¨ | Stage Right |
| Y | å‰ | å‘å‰ç§»åŠ¨ | Downstageï¼ˆé¢å‘è§‚ä¼—ï¼‰|
| Z | ä¸Š | å‘ä¸Šç§»åŠ¨ | Up |

**å•ä½**: å˜ç±³ (cm) âš ï¸ é‡è¦  
**æ—‹è½¬**: æ¬§æ‹‰è§’ï¼ˆåº¦ï¼‰ï¼ŒXYZé¡ºåº
**æ‰‹æ€§**: å³æ‰‹åæ ‡ç³»

> **ä¸ºä»€ä¹ˆä½¿ç”¨å˜ç±³ï¼Ÿ**
> - ä¸ UE å•ä½ä¸€è‡´ï¼Œå‡å°‘è½¬æ¢è¯¯å·®
> - ä¸å¤§å¤šæ•° DCC è½¯ä»¶ï¼ˆ3ds Maxã€Mayaï¼‰ä¸€è‡´
> - ç²¾åº¦æ›´é«˜ï¼Œé¿å…å°æ•°ç²¾åº¦é—®é¢˜

### 5.1.1 æ‰‹æ€§ä¸æ—‹è½¬æ–¹å‘ï¼ˆâš ï¸ å…³é”®ï¼‰

**å·¦æ‰‹ç³» vs å³æ‰‹ç³»çš„æ—‹è½¬æ–¹å‘ç›¸åï¼**

```
å³æ‰‹æ³•åˆ™ï¼ˆStandard/MA/VWï¼‰ï¼š     å·¦æ‰‹æ³•åˆ™ï¼ˆUnity/UEï¼‰ï¼š
æ‹‡æŒ‡æŒ‡å‘è½´æ­£æ–¹å‘                  æ‹‡æŒ‡æŒ‡å‘è½´æ­£æ–¹å‘
å››æŒ‡å¼¯æ›²æ–¹å‘ = æ­£æ—‹è½¬æ–¹å‘         å››æŒ‡å¼¯æ›²æ–¹å‘ = æ­£æ—‹è½¬æ–¹å‘

ä»è½´æ­£æ–¹å‘çœ‹ï¼š                    ä»è½´æ­£æ–¹å‘çœ‹ï¼š
æ­£è§’åº¦ = é€†æ—¶é’ˆ                   æ­£è§’åº¦ = é¡ºæ—¶é’ˆ
```

**ç»“è®º**ï¼šå½“ä»å·¦æ‰‹ç³»è½¬æ¢åˆ°å³æ‰‹ç³»ï¼ˆæˆ–åä¹‹ï¼‰æ—¶ï¼Œ**æ‰€æœ‰æ—‹è½¬è§’åº¦éƒ½éœ€è¦å–å**ï¼

```
å·¦æ‰‹ç³» â†’ å³æ‰‹ç³»:
  stdRot.X = -localRot.X
  stdRot.Y = -localRot.Y  (è½´é‡æ˜ å°„å)
  stdRot.Z = -localRot.Z  (è½´é‡æ˜ å°„å)
```

### 5.2 å„å¹³å°åæ ‡ç³»

> **é‡è¦åŸåˆ™**: æ¯ä¸ªå¹³å°åœ¨å‘é€æ•°æ®æ—¶å°†æœ¬åœ°åæ ‡è½¬æ¢ä¸ºæ ‡å‡†åæ ‡ç³»ï¼Œåœ¨æ¥æ”¶æ•°æ®æ—¶å°†æ ‡å‡†åæ ‡ç³»è½¬æ¢ä¸ºæœ¬åœ°åæ ‡ç³»ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿è·¨å¹³å°æ•°æ®çš„æ­£ç¡®æ€§ã€‚

| å¹³å° | åæ ‡ç³» | å•ä½ | è½´å®šä¹‰ | éœ€è¦å•ä½è½¬æ¢ |
|------|--------|------|--------|--------------|
| **Standard** | å³æ‰‹ Z-up | cm | Xå³, Yå‰, Zä¸Š | - |
| Unity | å·¦æ‰‹ Y-up | m | Xå³, Yä¸Š, Zå‰ | âœ… mâ†’cm |
| UE | å·¦æ‰‹ Z-up | cm | Xå‰, Yå³, Zä¸Š | âŒ |
| MA | å³æ‰‹ Z-up | m | Xå³, Yå‰, Zä¸Š | âœ… mâ†’cm |
| VW | å³æ‰‹ Z-up | mm | Xå³, Yå‰, Zä¸Š | âœ… mmâ†’cm |

#### 5.2.1 Unity (å·¦æ‰‹ Y-up, å•ä½: m)

```
Unity:               Standard:
    Y (ä¸Š)              Z (ä¸Š)
    â”‚                   â”‚
    â”‚                   â”‚
    â”‚                   â”‚
    â””â”€â”€â”€â”€ X (å³)        â””â”€â”€â”€â”€ Y (å‰)
   /                   /
  Z (å‰)              X (å³)
```

**å•ä½**: Unity ä½¿ç”¨ç±³ (m)ï¼Œéœ€è¦ä¸æ ‡å‡†åæ ‡ç³» cm è½¬æ¢

**è½¬æ¢å…¬å¼**:

> âš ï¸ **é‡è¦**ï¼šUnity æ˜¯å·¦æ‰‹ç³»ï¼ŒStandard æ˜¯å³æ‰‹ç³»ï¼Œ**æ‰€æœ‰æ—‹è½¬è½´éƒ½éœ€è¦å–å**ï¼

```
Unity â†’ Standard:
  // ä½ç½®è½¬æ¢ (m â†’ cm) + è½´é‡æ˜ å°„
  stdPos.X = unityPos.X * 100    // X(å³) â†’ X(å³)
  stdPos.Y = unityPos.Z * 100    // Z(å‰) â†’ Y(å‰)
  stdPos.Z = unityPos.Y * 100    // Y(ä¸Š) â†’ Z(ä¸Š)
  
  // æ—‹è½¬è½¬æ¢ï¼šè½´é‡æ˜ å°„ + æ‰‹æ€§ä¿®æ­£ï¼ˆå…¨éƒ¨å–åï¼‰
  stdRot.X = -unityRot.X         // ç»•å³è½´ï¼Œæ‰‹æ€§ç›¸å
  stdRot.Y = -unityRot.Z         // ç»•å‰è½´ï¼Œæ‰‹æ€§ç›¸å
  stdRot.Z = -unityRot.Y         // ç»•ä¸Šè½´ï¼Œæ‰‹æ€§ç›¸å

Standard â†’ Unity:
  // ä½ç½®è½¬æ¢ (cm â†’ m) + è½´é‡æ˜ å°„
  unityPos.X = stdPos.X * 0.01   // X(å³) â†’ X(å³)
  unityPos.Y = stdPos.Z * 0.01   // Z(ä¸Š) â†’ Y(ä¸Š)
  unityPos.Z = stdPos.Y * 0.01   // Y(å‰) â†’ Z(å‰)
  
  // æ—‹è½¬è½¬æ¢ï¼šè½´é‡æ˜ å°„ + æ‰‹æ€§ä¿®æ­£ï¼ˆå…¨éƒ¨å–åï¼‰
  unityRot.X = -stdRot.X         // ç»•å³è½´ï¼Œæ‰‹æ€§ç›¸å
  unityRot.Y = -stdRot.Z         // ç»•ä¸Šè½´ï¼Œæ‰‹æ€§ç›¸å
  unityRot.Z = -stdRot.Y         // ç»•å‰è½´ï¼Œæ‰‹æ€§ç›¸å
```

#### 5.2.2 Unreal Engine (å·¦æ‰‹ Z-up, å•ä½: cm)

```
UE:                  Standard:
    Z (ä¸Š)              Z (ä¸Š)
    â”‚                   â”‚
    â”‚                   â”‚
    â”‚                   â”‚
    â””â”€â”€â”€â”€ Y (å³)        â””â”€â”€â”€â”€ Y (å‰)
   /                   /
  X (å‰)              X (å³)
```

**å•ä½**: UE ä½¿ç”¨å˜ç±³ (cm)ï¼Œä¸æ ‡å‡†åæ ‡ç³»ç›¸åŒï¼Œæ— éœ€è½¬æ¢å•ä½

**è½¬æ¢å…¬å¼**:

```
UE æ¬§æ‹‰è§’å®šä¹‰ï¼ˆFRotatorï¼‰ï¼š
  Pitch (ç»•å³è½´/Yè½´æ—‹è½¬)
  Yaw   (ç»•ä¸Šè½´/Zè½´æ—‹è½¬)
  Roll  (ç»•å‰è½´/Xè½´æ—‹è½¬)

Standard æ¬§æ‹‰è§’å®šä¹‰ï¼š
  X = ç»•å³è½´æ—‹è½¬ (å¯¹åº” UE Pitch)
  Y = ç»•å‰è½´æ—‹è½¬ (å¯¹åº” UE Roll)
  Z = ç»•ä¸Šè½´æ—‹è½¬ (å¯¹åº” UE Yaw)

UE â†’ Standard:
  // ä½ç½®è½¬æ¢ï¼ˆè½´é‡æ˜ å°„ï¼Œå•ä½ç›¸åŒï¼‰
  stdPos.X = uePos.Y             // Y(å³) â†’ X(å³)
  stdPos.Y = uePos.X             // X(å‰) â†’ Y(å‰)
  stdPos.Z = uePos.Z             // Z(ä¸Š) â†’ Z(ä¸Š)
  
  // æ—‹è½¬è½¬æ¢ï¼ˆæŒ‰è½´ç‰©ç†æ„ä¹‰æ˜ å°„ + 180Â°åç§»ï¼‰
  stdRot.X = ueRot.Pitch         // ç»•å³è½´
  stdRot.Y = ueRot.Roll          // ç»•å‰è½´
  stdRot.Z = ueRot.Yaw - 180     // ç»•ä¸Šè½´ï¼Œå‡180Â°åç§»

Standard â†’ UE:
  // ä½ç½®è½¬æ¢ï¼ˆè½´é‡æ˜ å°„ï¼Œå•ä½ç›¸åŒï¼‰
  uePos.X = stdPos.Y             // Y(å‰) â†’ X(å‰)
  uePos.Y = stdPos.X             // X(å³) â†’ Y(å³)
  uePos.Z = stdPos.Z             // Z(ä¸Š) â†’ Z(ä¸Š)
  
  // æ—‹è½¬è½¬æ¢ï¼ˆæŒ‰è½´ç‰©ç†æ„ä¹‰æ˜ å°„ + 180Â°åç§»ï¼‰
  ueRot.Pitch = stdRot.X         // ç»•å³è½´
  ueRot.Roll  = stdRot.Y         // ç»•å‰è½´
  ueRot.Yaw   = stdRot.Z + 180   // ç»•ä¸Šè½´ï¼ŒåŠ 180Â°åç§»
```

> **æ³¨æ„**ï¼šYaw éœ€è¦ Â±180Â° åç§»æ˜¯å› ä¸º UE å’Œ Standard çš„"å‰æ–¹"å®šä¹‰åœ¨ç»è¿‡è½´é‡æ˜ å°„åå­˜åœ¨ 180Â° çš„æœå‘å·®å¼‚ã€‚

#### 5.2.3 GrandMA2 (å³æ‰‹ Z-up, å•ä½: m)

```
MA2:                 Standard:
    Z (ä¸Š)              Z (ä¸Š)
    â”‚                   â”‚
    â”‚                   â”‚
    â”‚                   â”‚
    â””â”€â”€â”€â”€ Y (å‰)        â””â”€â”€â”€â”€ Y (å‰)
   /                   /
  X (å³)              X (å³)
```

**å•ä½**: MA2 ä½¿ç”¨ç±³ (m)ï¼ŒStandard ä½¿ç”¨å˜ç±³ (cm)ï¼Œéœ€è¦è½¬æ¢å•ä½

**è½¬æ¢å…¬å¼**:

```
Standard â†’ MA2:
  // ä½ç½®è½¬æ¢ (cm â†’ m)
  ma2Pos.X = stdPos.X * 0.01   // X(å³) â†’ X(å³)
  ma2Pos.Y = stdPos.Y * 0.01   // Y(å‰) â†’ Y(å‰)
  ma2Pos.Z = stdPos.Z * 0.01   // Z(ä¸Š) â†’ Z(ä¸Š)
  
  // æ—‹è½¬è½¬æ¢ï¼ˆæ ¹æ®å®æµ‹ä¿®æ­£ï¼‰
  ma2Rot.X = stdRot.X          // ç»•å³è½´ï¼Œä¸å˜
  ma2Rot.Y = stdRot.Y + 180    // ç»•å‰è½´ï¼Œ+180Â°
  ma2Rot.Z = stdRot.Z + 90     // ç»•ä¸Šè½´ï¼Œ+90Â°

MA2 â†’ Standard:
  // ä½ç½®è½¬æ¢ (m â†’ cm)
  stdPos.X = ma2Pos.X * 100    // X(å³) â†’ X(å³)
  stdPos.Y = ma2Pos.Y * 100    // Y(å‰) â†’ Y(å‰)
  stdPos.Z = ma2Pos.Z * 100    // Z(ä¸Š) â†’ Z(ä¸Š)
  
  // æ—‹è½¬è½¬æ¢
  stdRot.X = ma2Rot.X          // ç»•å³è½´ï¼Œä¸å˜
  stdRot.Y = ma2Rot.Y - 180    // ç»•å‰è½´ï¼Œ-180Â°
  stdRot.Z = ma2Rot.Z - 90     // ç»•ä¸Šè½´ï¼Œ-90Â°
```

> **æ³¨æ„**ï¼šMA2 çš„æ—‹è½¬åç§»æ˜¯æ ¹æ®å®é™…æµ‹è¯•å¾—å‡ºçš„ç»éªŒå€¼ï¼Œå¯èƒ½ä¸ç¯å…·é»˜è®¤æœå‘æœ‰å…³ã€‚

### 5.3 åæ ‡è½¬æ¢çŸ©é˜µ

#### Unity â†” Standard

```
Unityâ†’Standard ä½ç½®çŸ©é˜µ:     Standardâ†’Unity ä½ç½®çŸ©é˜µ:
â”Œ 1  0  0 â”                  â”Œ 1  0  0 â”
â”‚ 0  0  1 â”‚                  â”‚ 0  0  1 â”‚
â”” 0  1  0 â”˜                  â”” 0  1  0 â”˜
```

#### UE â†” Standard

```
UEâ†’Standard ä½ç½®çŸ©é˜µ:        Standardâ†’UE ä½ç½®çŸ©é˜µ:
â”Œ 0  1  0 â”                  â”Œ 0  1  0 â”
â”‚ 1  0  0 â”‚                  â”‚ 1  0  0 â”‚
â”” 0  0  1 â”˜                  â”” 0  0  1 â”˜

ï¼ˆå•ä½ç›¸åŒï¼Œä»… Xâ†”Y äº¤æ¢ï¼‰
```

---

## 6. è¿æ¥ä¸æ•°æ®åŒæ­¥æµç¨‹

### 6.1 å®¢æˆ·ç«¯å¯åŠ¨æµç¨‹

```
å®¢æˆ·ç«¯æ‰“å¼€è¿æ¥é¢æ¿
        â”‚
        â–¼
  å°è¯• TCP è¿æ¥ localhost:5966
        â”‚
        â”œâ”€ è¿æ¥æˆåŠŸ â†’ æœåŠ¡å·²è¿è¡Œ â†’ å‘é€ Connect
        â”‚
        â””â”€ è¿æ¥å¤±è´¥ â†’ å¯åŠ¨ SuperDataServer.exe
                            â”‚
                            â–¼
                      è½®è¯¢ç­‰å¾…ç«¯å£å°±ç»ªï¼ˆæœ€å¤š5ç§’ï¼‰
                            â”‚
                            â–¼
                      TCP è¿æ¥ â†’ å‘é€ Connect
```

### 6.2 åŠ å…¥ç¾¤èŠæµç¨‹

> âš ï¸ **é‡è¦æé†’**ï¼š
> - å»ºç«‹ TCP è¿æ¥åå¿…é¡»è®¾ç½® `TCP_NODELAY = true`ï¼ˆè§ 8.8ï¼‰
> - æ¥æ”¶æ•°æ®æ—¶å¿…é¡»å¤„ç† TCP ç²˜åŒ…ï¼ˆè§ 8.7ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–°å®¢æˆ·ç«¯(UE)  â”‚                              â”‚ Server  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
       â”‚                                           â”‚
       â”‚  â•â•â•â•â•â•â• TCP Connect â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º â”‚
       â”‚         (è®¾ç½® TCP_NODELAY=true)            â”‚
       â”‚                                           â”‚
       â”‚  â”€â”€â”€â”€ Connect (0x0010) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚
       â”‚       {clientId, clientName, platform}    â”‚
       â”‚                                           â”‚
       â”‚  â—„â”€â”€â”€ ConnectAck (0x0011) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
       â”‚       {clients: [Unity, VW, ...]}         â”‚  è¿”å›å½“å‰ç¾¤æˆå‘˜
       â”‚                                           â”‚
       â”‚  â”€â”€â”€â”€ FixtureFullSync (0x0023) â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚  ä¸ŠæŠ¥è‡ªå·±çš„ç¯å…·
       â”‚       {fixtures: [...]}                   â”‚
       â”‚                                           â”‚
       â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€ Heartbeat â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  (æ¯3ç§’)
       â”‚                                           â”‚
       â–¼                                           â–¼

åŒæ—¶ï¼ŒServer å¹¿æ’­ç»™ç¾¤å†…å…¶ä»–å®¢æˆ·ç«¯ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Server  â”‚                              â”‚ å·²æœ‰å®¢æˆ·ç«¯    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                          â”‚
     â”‚  â”€â”€â”€â”€ ClientJoined (0x0014) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚
     â”‚       {clientId, clientName, platform}   â”‚
     â”‚                                          â”‚
     â–¼                                          â–¼
```

### 6.3 ä»å…¶ä»–å®¢æˆ·ç«¯å¯¼å…¥æ•°æ®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UE å®¢æˆ·ç«¯â”‚                              â”‚ Server  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                                        â”‚
     â”‚  ç”¨æˆ·é€‰æ‹©"ä» Unity å¯¼å…¥"                â”‚
     â”‚                                        â”‚
     â”‚  â”€â”€â”€â”€ FixtureListRequest (0x0020) â”€â”€â”€â–º â”‚
     â”‚       {sourceClientId: "unity-xxx"}    â”‚
     â”‚                                        â”‚
     â”‚  â—„â”€â”€â”€ FixtureListResponse (0x0021) â”€â”€â”€ â”‚
     â”‚       {sourceClientId, fixtures: [...]}â”‚  è¿”å› Unity çš„ç¯å…·æ•°æ®
     â”‚                                        â”‚
     â”‚  [UE æœ¬åœ°åˆ›å»º/æ›´æ–°ç¯å…·]                 â”‚
     â”‚                                        â”‚
     â–¼                                        â–¼
```

### 6.4 æ•°æ®å˜æ›´å¹¿æ’­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Unity   â”‚                              â”‚ Server  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                                        â”‚
     â”‚  ç”¨æˆ·ç§»åŠ¨äº†ä¸€ä¸ªç¯å…·                     â”‚
     â”‚                                        â”‚
     â”‚  â”€â”€â”€â”€ FixtureUpdate (0x0022) â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚
     â”‚       {uuid, changes: {position: ...}} â”‚
     â”‚                                        â”‚
     â”‚                                        â–¼
     â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                              â”‚ æ›´æ–° Unity ç¼“å­˜  â”‚
     â”‚                              â”‚ å¹¿æ’­ç»™å…¶ä»–å®¢æˆ·ç«¯ â”‚
     â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                        â”‚
     â”‚                                        â”‚  FixtureUpdate
     â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                              â–¼                   â–¼
     â”‚                            UE                   VW
     â”‚                       (æ”¶åˆ°å˜æ›´é€šçŸ¥)        (æ”¶åˆ°å˜æ›´é€šçŸ¥)
     â–¼
```

### 6.5 å®¢æˆ·ç«¯ç¦»å¼€ä¸æœåŠ¡é€€å‡º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Unity   â”‚                              â”‚ Server  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                                        â”‚
     â”‚  ç”¨æˆ·å…³é—­è¿æ¥                           â”‚
     â”‚                                        â”‚
     â”‚  â”€â”€â”€â”€ Disconnect (0x0012) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚
     â”‚                                        â”‚
     â”‚  â•â•â•â•â•â•â• TCP æ–­å¼€ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º â”‚
     â”‚                                        â”‚
                                              â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ ç§»é™¤ Unity ä¼šè¯  â”‚
                                    â”‚ æ¸…é™¤ Unity æ•°æ®  â”‚
                                    â”‚ å¹¿æ’­ ClientLeft  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                    æ£€æŸ¥è¿æ¥æ•°æ˜¯å¦ä¸º0
                                              â”‚
                                    â”œâ”€ ä¸ä¸º0 â†’ ç»§ç»­è¿è¡Œ
                                    â”‚
                                    â””â”€ ä¸º0 â†’ ç«‹å³é€€å‡ºè¿›ç¨‹
```

---

## 7. é”™è¯¯å¤„ç†

### 7.1 é”™è¯¯ä»£ç 

| ä»£ç  | åç§° | è¯´æ˜ |
|------|------|------|
| 0 | None | æ— é”™è¯¯ |
| 1 | InvalidPacket | æ— æ•ˆæ•°æ®åŒ…æ ¼å¼ |
| 2 | VersionMismatch | åè®®ç‰ˆæœ¬ä¸åŒ¹é… |
| 3 | ConnectionRefused | è¿æ¥è¢«æ‹’ç» |
| 4 | Timeout | æ“ä½œè¶…æ—¶ |
| 5 | TypeMappingRequired | éœ€è¦ç±»å‹æ˜ å°„ |
| 6 | FixtureNotFound | ç¯å…·æœªæ‰¾åˆ° |
| 7 | PermissionDenied | æƒé™ä¸è¶³ |
| 255 | InternalError | å†…éƒ¨é”™è¯¯ |

### 7.2 é”™è¯¯å“åº”æ ¼å¼

```json
{
    "errorCode": 1,
    "errorMessage": "Invalid packet format",
    "details": "Magic header mismatch"
}
```

---

## 8. å®ç°æŒ‡å—

### 8.1 æœåŠ¡ç«¯å®ç°ï¼ˆSuperDataServer.exeï¼‰

æœåŠ¡ç«¯ä½œä¸ºç‹¬ç«‹è¿›ç¨‹ï¼Œç”± C++ å®ç°ï¼Œå„å¹³å°å®¢æˆ·ç«¯å…±äº«ä½¿ç”¨ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **TCP æœåŠ¡å™¨** - ç›‘å¬ localhost:5966
2. **ä¼šè¯ç®¡ç†** - ç®¡ç†æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥
3. **æ•°æ®ç¼“å­˜** - ç¼“å­˜æ¯ä¸ªå®¢æˆ·ç«¯çš„ç¯å…·æ•°æ®
4. **æ¶ˆæ¯è·¯ç”±** - è½¬å‘/å¹¿æ’­æ¶ˆæ¯ç»™ç›¸å…³å®¢æˆ·ç«¯
5. **è‡ªåŠ¨é€€å‡º** - æœ€åå®¢æˆ·ç«¯æ–­å¼€æ—¶é€€å‡ºè¿›ç¨‹
6. **å•å®ä¾‹** - ä½¿ç”¨å‘½åäº’æ–¥é”é˜²æ­¢é‡å¤å¯åŠ¨

**è¿›ç¨‹ç‰¹æ€§**ï¼š
- æ— çª—å£åå°è¿è¡Œï¼ˆWindows: SUBSYSTEM:WINDOWSï¼‰
- ç³»ç»Ÿçº§å®‰è£…ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯å…±äº«

### 8.2 å®‰è£…ä¸éƒ¨ç½²

#### 8.2.1 ä¸‹è½½å®‰è£…

**ä¸‹è½½åœ°å€**ï¼š[https://yunsio.com/superdata/download](https://yunsio.com/superdata/download)

**å®‰è£…åŒ…**ï¼š`SuperDataSetup-2.0.0.exe`ï¼ˆçº¦ 2.2 MBï¼‰

**å®‰è£…æ­¥éª¤**ï¼š
1. ä¸‹è½½å¹¶è¿è¡Œå®‰è£…åŒ…
2. é€‰æ‹©è¯­è¨€ï¼ˆä¸­æ–‡/Englishï¼‰
3. æŒ‰å‘å¯¼å®Œæˆå®‰è£…
4. æ— éœ€æ‰‹åŠ¨é…ç½®ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨å¯åŠ¨æœåŠ¡

#### 8.2.2 å®‰è£…ä½ç½®

SuperDataServer ä½œä¸ºç‹¬ç«‹è½¯ä»¶å®‰è£…åˆ°ç³»ç»Ÿï¼Œæ‰€æœ‰å®¢æˆ·ç«¯å…±äº«ä½¿ç”¨ï¼š

**é»˜è®¤å®‰è£…è·¯å¾„**ï¼š
```
C:\Program Files\Yunsio\SuperData\
â”œâ”€â”€ SuperDataServer.exe    # æœåŠ¡å™¨ä¸»ç¨‹åº
â”œâ”€â”€ version.txt            # ç‰ˆæœ¬ä¿¡æ¯
â””â”€â”€ unins000.exe           # å¸è½½ç¨‹åº
```

**æ³¨å†Œè¡¨é…ç½®**ï¼ˆè‡ªåŠ¨å†™å…¥ï¼‰ï¼š
```
HKEY_LOCAL_MACHINE\SOFTWARE\Yunsio\SuperData
â”œâ”€â”€ InstallPath  (REG_SZ)  = "C:\Program Files\Yunsio\SuperData"
â”œâ”€â”€ Version      (REG_SZ)  = "2.0.0"
â””â”€â”€ ExePath      (REG_SZ)  = "C:\Program Files\Yunsio\SuperData\SuperDataServer.exe"
```

#### 8.2.3 å®¢æˆ·ç«¯æŸ¥æ‰¾æœåŠ¡é€»è¾‘

```pseudocode
function FindServerExePath():
    // 1. æŸ¥è¯¢æ³¨å†Œè¡¨
    regPath = "HKEY_LOCAL_MACHINE\\SOFTWARE\\Yunsio\\SuperData"
    exePath = Registry.GetValue(regPath, "ExePath")
    
    if exePath != null and FileExists(exePath):
        return exePath
    
    // 2. æ£€æŸ¥ PATH ç¯å¢ƒå˜é‡
    exePath = FindInPath("SuperDataServer.exe")
    if exePath != null:
        return exePath
    
    // 3. æœªå®‰è£…
    return Error("SuperData Server æœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…: https://yunsio.com/superdata")
```

#### 8.2.4 å®‰è£…åŒ…åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| å¤šè¯­è¨€ | æ”¯æŒä¸­æ–‡/è‹±æ–‡ç•Œé¢åˆ‡æ¢ |
| å®‰è£… | å¤åˆ¶æ–‡ä»¶ã€å†™æ³¨å†Œè¡¨ã€åˆ›å»ºå¿«æ·æ–¹å¼ |
| å¸è½½ | è‡ªåŠ¨å…³é—­è¿›ç¨‹ã€åˆ é™¤æ–‡ä»¶ã€æ¸…ç†æ³¨å†Œè¡¨ |
| å‡çº§ | æ£€æµ‹æ—§ç‰ˆæœ¬ã€è‡ªåŠ¨æ›¿æ¢ |
| é™é»˜å®‰è£… | æ”¯æŒ `/SILENT` å‚æ•°ç”¨äºè‡ªåŠ¨åŒ–éƒ¨ç½² |

### 8.3 å®¢æˆ·ç«¯æœ€å°å®ç°è¦æ±‚

å®ç°ä¸€ä¸ªå…¼å®¹çš„ SuperData å®¢æˆ·ç«¯ï¼Œåªéœ€è¦ï¼š

1. **è‡ªåŠ¨å¯åŠ¨** - ä»æ³¨å†Œè¡¨æŸ¥æ‰¾å¹¶å¯åŠ¨ SuperDataServer.exeï¼ˆè§ 8.4ï¼‰
2. **TCP è¿æ¥** - è¿æ¥åˆ° localhost:5966
3. **æ•°æ®åŒ…è§£æ** - è§£æ 24 å­—èŠ‚å¤´ + JSON è´Ÿè½½
4. **å¿ƒè·³æœºåˆ¶** - æ¯ 3 ç§’å‘é€å¿ƒè·³
5. **åæ ‡è½¬æ¢** - å®ç°æœ¬åœ°åæ ‡ç³»ä¸æ ‡å‡†åæ ‡ç³»è½¬æ¢
6. **TCP ç²˜åŒ…å¤„ç†** - âš ï¸ å¿…é¡»å¤„ç† TCP ç²˜åŒ…ï¼ˆè§ 8.7ï¼‰
7. **ç¦ç”¨ Nagle** - âš ï¸ å¿…é¡»è®¾ç½® TCP_NODELAYï¼ˆè§ 8.8ï¼‰
8. **ç¦ç”¨ä»£ç†** - âš ï¸ å¿…é¡»ç¦ç”¨ç³»ç»Ÿä»£ç†ï¼ˆè§ 8.9ï¼‰

> ğŸ’¡ **æç¤º**ï¼šæ‰€æœ‰ 8 ç§è¯­è¨€çš„å®¢æˆ·ç«¯ç¤ºä¾‹åº“éƒ½å·²å†…ç½®ä¸Šè¿°å…¨éƒ¨åŠŸèƒ½ï¼Œå¯ç›´æ¥ä½¿ç”¨ã€‚

### 8.4 å®¢æˆ·ç«¯å¯åŠ¨æœåŠ¡é€»è¾‘

> **é‡è¦**ï¼šæ‰€æœ‰å®¢æˆ·ç«¯ç¤ºä¾‹åº“éƒ½å·²å†…ç½® `ensureServerRunning()` å‡½æ•°ï¼Œå¹¶åœ¨ `connect()` æ–¹æ³•ä¸­é»˜è®¤è‡ªåŠ¨è°ƒç”¨ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ åªéœ€è°ƒç”¨ `client.connect()` å³å¯ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†æœåŠ¡å™¨å¯åŠ¨é€»è¾‘ã€‚

```pseudocode
function EnsureServerRunning():
    // 1. å°è¯•è¿æ¥ï¼ˆæœåŠ¡å¯èƒ½å·²è¿è¡Œï¼‰
    socket = TryConnect("127.0.0.1", 5966, timeout=100ms)
    if socket.connected:
        return socket
    
    // 2. æŸ¥æ‰¾ exe è·¯å¾„
    exePath = FindServerExePath()
    if exePath.error:
        return Error("SuperData Server æœªå®‰è£…")
    
    // 3. å¯åŠ¨æœåŠ¡
    LaunchProcess(exePath, hidden=true)
    
    // 4. ç­‰å¾…ç«¯å£å°±ç»ª
    for i in 1..50:  // æœ€å¤š 5 ç§’
        sleep(100ms)
        socket = TryConnect("127.0.0.1", 5966, timeout=100ms)
        if socket.connected:
            return socket
    
    return Error("Failed to start server")
```

#### 8.4.1 å„è¯­è¨€å®¢æˆ·ç«¯ API

| è¯­è¨€ | å¯¼å…¥ | è‡ªåŠ¨å¯åŠ¨ connect |
|------|------|-----------------|
| Python | `from superdata import SuperDataClient, ensure_server_running` | `await client.connect()` |
| JavaScript | `const { SuperDataClient, ensureServerRunning } = require('superdata')` | `await client.connect()` |
| TypeScript | `import { Client, ensureServerRunning } from 'superdata'` | `await client.connect()` |
| C# | `using SuperData;` | `await client.ConnectAsync()` |
| C++ | `#include "ServerLauncher.h"` | `client.Connect()` |
| Rust | `use superdata::{Client, ensure_server_running}` | `client.connect("127.0.0.1", 5966).await` |
| Java | `import com.yunsio.superdata.ServerLauncher;` | `client.connect()` |
| Lua | `local ServerLauncher = require("superdata.server_launcher")` | `client:connect()` |

æ‰€æœ‰ `connect()` æ–¹æ³•éƒ½æ”¯æŒ `autoStartServer` å‚æ•°ï¼ˆé»˜è®¤ `true`ï¼‰ï¼Œå¦‚éœ€ç¦ç”¨è‡ªåŠ¨å¯åŠ¨ï¼š

```python
# Python
await client.connect(auto_start_server=False)
```

```javascript
// JavaScript/TypeScript
await client.connect('127.0.0.1', 5966, false);
```

```csharp
// C#
await client.ConnectAsync("127.0.0.1", 5966, autoStartServer: false);
```

**å„å¹³å°å®ç°**ï¼š

```csharp
// Unity (C#) - æŸ¥æ‰¾å¹¶å¯åŠ¨
string GetServerPath() {
    using var key = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Yunsio\SuperData");
    return key?.GetValue("ExePath") as string;
}

void StartServer() {
    var exePath = GetServerPath();
    if (string.IsNullOrEmpty(exePath)) {
        Debug.LogError("SuperData Server æœªå®‰è£…");
        return;
    }
    Process.Start(new ProcessStartInfo {
        FileName = exePath,
        CreateNoWindow = true,
        UseShellExecute = false
    });
}
```

```cpp
// UE (C++) - æŸ¥æ‰¾å¹¶å¯åŠ¨
FString GetServerPath() {
    FString ExePath;
    FWindowsPlatformMisc::QueryRegKey(
        HKEY_LOCAL_MACHINE,
        TEXT("SOFTWARE\\Yunsio\\SuperData"),
        TEXT("ExePath"),
        ExePath);
    return ExePath;
}

void StartServer() {
    FString ExePath = GetServerPath();
    if (ExePath.IsEmpty()) {
        UE_LOG(LogTemp, Error, TEXT("SuperData Server not installed"));
        return;
    }
    FPlatformProcess::CreateProc(*ExePath, nullptr, true, false, false,
        nullptr, 0, nullptr, nullptr);
}
```

```lua
-- MA2 (Lua) - æŸ¥æ‰¾å¹¶å¯åŠ¨
function getServerPath()
    local handle = io.popen('reg query "HKLM\\SOFTWARE\\Yunsio\\SuperData" /v ExePath 2>nul')
    local result = handle:read("*a")
    handle:close()
    local path = result:match("ExePath%s+REG_SZ%s+(.+)%s*$")
    return path and path:gsub("%s+$", "") or nil
end

function startServer()
    local exePath = getServerPath()
    if not exePath then
        print("SuperData Server not installed")
        return false
    end
    os.execute('start /B "" "' .. exePath .. '"')
    return true
end
```

### 8.5 ä¼ªä»£ç ç¤ºä¾‹

#### 8.5.1 å‘é€æ•°æ®åŒ…

```pseudocode
function SendPacket(socket, packetType, payload):
    // æ„å»ºå¤´éƒ¨
    header = new byte[24]
    header[0:4] = "SPDT"
    header[4:6] = PROTOCOL_VERSION  // Little Endian
    header[6:8] = packetType        // Little Endian
    header[8:12] = sequenceNumber++ // Little Endian
    header[12:20] = currentTimeMs() // Little Endian
    
    payloadBytes = UTF8.Encode(payload)
    header[20:24] = payloadBytes.Length // Little Endian
    
    // å‘é€
    socket.Send(header + payloadBytes)
```

#### 8.5.2 æ¥æ”¶æ•°æ®åŒ…

```pseudocode
function ReceivePacket(socket):
    // è¯»å–å¤´éƒ¨
    header = socket.Receive(24)
    
    // éªŒè¯é­”æ•°
    if header[0:4] != "SPDT":
        return Error("Invalid magic")
    
    // è§£æå¤´éƒ¨
    version = ReadUInt16LE(header, 4)
    packetType = ReadUInt16LE(header, 6)
    sequence = ReadUInt32LE(header, 8)
    timestamp = ReadInt64LE(header, 12)
    payloadLength = ReadUInt32LE(header, 20)
    
    // è¯»å–è´Ÿè½½
    payload = socket.Receive(payloadLength)
    payloadJson = UTF8.Decode(payload)
    
    return (packetType, payloadJson)
```

#### 8.5.3 å®¢æˆ·ç«¯å®Œæ•´è¿æ¥æµç¨‹

```pseudocode
function ConnectToSuperData():
    // 1. ç¡®ä¿æœåŠ¡è¿è¡Œ
    socket = EnsureServerRunning()
    if socket.error:
        return Error("Cannot start server")
    
    // 2. å‘é€ Connect
    myClientId = GenerateUUID()
    SendPacket(socket, PKT_CONNECT, {
        clientId: myClientId,
        clientName: GetProjectName(),
        platform: PLATFORM_CODE,
        platformVersion: GetPlatformVersion(),
        protocolVersion: "2.0.0"
    })
    
    // 3. ç­‰å¾… ConnectAck
    response = ReceivePacket(socket)
    if response.type != PKT_CONNECT_ACK:
        return Error("Unexpected response")
    
    if not response.payload.accepted:
        return Error(response.payload.errorMessage)
    
    // 4. ä¿å­˜ç¾¤æˆå‘˜åˆ—è¡¨
    otherClients = response.payload.clients
    
    // 5. ä¸ŠæŠ¥è‡ªå·±çš„ç¯å…·æ•°æ®
    myFixtures = GetAllLocalFixtures()
    SendPacket(socket, PKT_FIXTURE_FULL_SYNC, {
        fixtures: ConvertToStandardCoords(myFixtures),
        totalCount: myFixtures.length
    })
    
    // 6. å¯åŠ¨å¿ƒè·³çº¿ç¨‹
    StartHeartbeatThread(socket)
    
    return Success(socket, otherClients)
```

### 8.6 æµ‹è¯•æ£€æŸ¥æ¸…å•

- [ ] èƒ½å¯åŠ¨ SuperDataServer.exe
- [ ] èƒ½å»ºç«‹ TCP è¿æ¥å¹¶å®Œæˆæ¡æ‰‹
- [ ] èƒ½æ­£ç¡®å‘é€/å“åº”å¿ƒè·³
- [ ] èƒ½ä¸ŠæŠ¥è‡ªå·±çš„ç¯å…·æ•°æ®
- [ ] èƒ½è·å–å…¶ä»–å®¢æˆ·ç«¯åˆ—è¡¨
- [ ] èƒ½ä»æŒ‡å®šå®¢æˆ·ç«¯å¯¼å…¥ç¯å…·
- [ ] åæ ‡è½¬æ¢ç»“æœæ­£ç¡®
- [ ] èƒ½å¤„ç†ç½‘ç»œæ–­å¼€å¹¶é‡è¿
- [ ] TCP ç²˜åŒ…å¤„ç†æ­£ç¡®
- [ ] æ•°æ®ç«‹å³å‘é€ï¼ˆæ— å»¶è¿Ÿï¼‰
- [ ] æ”¶åˆ° ClientJoined/ClientLeft æ—¶æ­£ç¡®æ›´æ–° UI
- [ ] å·²ç¦ç”¨ç³»ç»Ÿä»£ç†ï¼ˆè¿æ¥ä¸è¢«ä»£ç†è½¬å‘ï¼‰

### 8.7 TCP ç²˜åŒ…å¤„ç†ï¼ˆâš ï¸ é‡è¦ï¼‰

TCP æ˜¯æµå¼åè®®ï¼Œ**å¤šä¸ªå°æ•°æ®åŒ…å¯èƒ½è¢«åˆå¹¶æˆä¸€ä¸ªå¤§åŒ…å‘é€**ã€‚è¿™æ˜¯ TCP çš„æ­£å¸¸è¡Œä¸ºï¼Œä½†å¦‚æœä¸æ­£ç¡®å¤„ç†ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚

#### 8.7.1 é—®é¢˜åœºæ™¯

å®¢æˆ·ç«¯è¿ç»­å‘é€ä¸¤ä¸ªè¯·æ±‚ï¼š
```
TypeListRequest (0x0030) + FixtureListRequest (0x0020)
```

ç”±äº TCP åˆå¹¶ï¼ŒæœåŠ¡ç«¯å¯èƒ½åœ¨ä¸€æ¬¡ `recv()` ä¸­æ”¶åˆ°ä¸¤ä¸ªè¯·æ±‚çš„æ•°æ®ã€‚å¦‚æœåªè§£æç¬¬ä¸€ä¸ªåŒ…ï¼Œç¬¬äºŒä¸ªè¯·æ±‚å°†è¢«ä¸¢å¼ƒï¼

#### 8.7.2 æ­£ç¡®å®ç°

**å¿…é¡»ä½¿ç”¨å¾ªç¯è§£æï¼Œç›´åˆ°ç¼“å†²åŒºä¸­æ²¡æœ‰å®Œæ•´æ•°æ®åŒ…**ï¼š

```pseudocode
pendingBuffer = []  // å¾…å¤„ç†ç¼“å†²åŒº

function OnDataReceived(newData):
    pendingBuffer.append(newData)
    
    // å¾ªç¯è§£ææ‰€æœ‰å®Œæ•´çš„æ•°æ®åŒ…
    while pendingBuffer.length >= HEADER_SIZE:
        
        // æ£€æŸ¥æ˜¯å¦æœ‰å®Œæ•´çš„å¤´éƒ¨
        if pendingBuffer[0:4] != "SPDT":
            // æ— æ•ˆæ•°æ®ï¼Œå°è¯•æ‰¾åˆ°ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„ magic
            findNextMagic()
            continue
        
        payloadLength = ReadUInt32LE(pendingBuffer, 20)
        totalPacketSize = HEADER_SIZE + payloadLength
        
        // æ•°æ®ä¸å®Œæ•´ï¼Œç­‰å¾…æ›´å¤šæ•°æ®
        if pendingBuffer.length < totalPacketSize:
            break
        
        // æå–å®Œæ•´æ•°æ®åŒ…
        packetData = pendingBuffer[0:totalPacketSize]
        pendingBuffer.removeRange(0, totalPacketSize)
        
        // å¤„ç†æ•°æ®åŒ…
        ProcessPacket(packetData)
```

#### 8.7.3 å¸¸è§é”™è¯¯

âŒ **é”™è¯¯åšæ³•**ï¼šåªè§£æä¸€æ¬¡
```pseudocode
data = socket.recv()
packet = ParsePacket(data)  // åªè§£æäº†ç¬¬ä¸€ä¸ªåŒ…ï¼
HandlePacket(packet)
```

âœ… **æ­£ç¡®åšæ³•**ï¼šå¾ªç¯è§£æ
```pseudocode
data = socket.recv()
buffer.append(data)
while (packet = TryParsePacket(buffer)) != null:
    HandlePacket(packet)
```

### 8.8 ç¦ç”¨ Nagle ç®—æ³•ï¼ˆâš ï¸ é‡è¦ï¼‰

Nagle ç®—æ³•ä¼š**ç¼“å†²å°æ•°æ®åŒ…**ï¼Œç­‰å¾…æ›´å¤šæ•°æ®åå†å‘é€ï¼Œè¿™ä¼šå¯¼è‡´ä¸¥é‡çš„å»¶è¿Ÿï¼ˆå¯èƒ½é•¿è¾¾æ•°ç§’ç”šè‡³æ•°åˆ†é’Ÿï¼‰ã€‚

#### 8.8.1 å¿…é¡»è®¾ç½® TCP_NODELAY

**æ‰€æœ‰ TCP è¿æ¥å¿…é¡»ç¦ç”¨ Nagle ç®—æ³•**ï¼š

```cpp
// C/C++
int flag = 1;
setsockopt(socket, IPPROTO_TCP, TCP_NODELAY, &flag, sizeof(flag));
```

```csharp
// C#
tcpClient.NoDelay = true;
```

```python
# Python
socket.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
```

```lua
-- Lua (LuaSocket)
tcp:setoption("tcp-nodelay", true)
```

#### 8.8.2 ä¸è®¾ç½® TCP_NODELAY çš„åæœ

| è®¾ç½® | å»¶è¿Ÿ | åæœ |
|------|------|------|
| âŒ æœªè®¾ç½® | 200ms - 5åˆ†é’Ÿ | å®¢æˆ·ç«¯è¿æ¥åé•¿æ—¶é—´æ”¶ä¸åˆ°æ•°æ® |
| âœ… å·²è®¾ç½® | < 10ms | æ•°æ®ç«‹å³å‘é€å’Œæ¥æ”¶ |

### 8.9 ç¦ç”¨ç³»ç»Ÿä»£ç†ï¼ˆâš ï¸ é‡è¦ï¼‰

SuperData ä½¿ç”¨æœ¬åœ° TCP è¿æ¥ (`127.0.0.1:5966`)ï¼Œ**å¿…é¡»ç¡®ä¿è¿æ¥ä¸è¢«ç³»ç»Ÿä»£ç†è½¬å‘**ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´è¿æ¥å¤±è´¥æˆ–æ•°æ®å¼‚å¸¸ã€‚

#### 8.9.1 ä¸ºä»€ä¹ˆéœ€è¦ç¦ç”¨ä»£ç†

- ä»£ç†è½¯ä»¶ï¼ˆå¦‚ Clashã€V2Rayã€Shadowsocksï¼‰å¯èƒ½ä¼šæ‹¦æˆªæœ¬åœ° TCP è¿æ¥
- å³ä½¿æ˜¯ localhost è¿æ¥ï¼ŒæŸäº›ä»£ç†é…ç½®ä¹Ÿä¼šè½¬å‘
- è½¬å‘åå¯èƒ½å¯¼è‡´è¿æ¥è¶…æ—¶ã€æ•°æ®ä¸¢å¤±æˆ–åè®®è§£æé”™è¯¯

#### 8.9.2 å®ç°æ–¹å¼

**æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åœ¨å¯åŠ¨æ—¶éƒ½åº”æ¸…é™¤ä»£ç†ç¯å¢ƒå˜é‡**ï¼š

```cpp
// C/C++
#ifdef _WIN32
    _putenv("http_proxy=");
    _putenv("HTTP_PROXY=");
    _putenv("https_proxy=");
    _putenv("HTTPS_PROXY=");
    _putenv("all_proxy=");
    _putenv("ALL_PROXY=");
    _putenv("no_proxy=*");
    _putenv("NO_PROXY=*");
#else
    unsetenv("http_proxy");
    unsetenv("HTTP_PROXY");
    // ... å…¶ä»–ä»£ç†å˜é‡
    setenv("no_proxy", "*", 1);
#endif
```

```csharp
// C#
string[] proxyVars = { "http_proxy", "HTTP_PROXY", "https_proxy", "HTTPS_PROXY", 
                       "all_proxy", "ALL_PROXY", "socks_proxy", "SOCKS_PROXY" };
foreach (var v in proxyVars)
    Environment.SetEnvironmentVariable(v, null);
Environment.SetEnvironmentVariable("no_proxy", "*");
```

```python
# Python
import os
proxy_vars = ["http_proxy", "HTTP_PROXY", "https_proxy", "HTTPS_PROXY",
              "all_proxy", "ALL_PROXY", "socks_proxy", "SOCKS_PROXY"]
for var in proxy_vars:
    os.environ.pop(var, None)
os.environ["no_proxy"] = "*"
```

```javascript
// JavaScript/Node.js
const proxyVars = ['http_proxy', 'HTTP_PROXY', 'https_proxy', 'HTTPS_PROXY',
                   'all_proxy', 'ALL_PROXY', 'socks_proxy', 'SOCKS_PROXY'];
for (const v of proxyVars)
    delete process.env[v];
process.env.no_proxy = '*';
```

#### 8.9.3 æœ€ä½³å®è·µ

- åœ¨æ¨¡å—/åº“åˆå§‹åŒ–æ—¶ç«‹å³ç¦ç”¨ä»£ç†ï¼ˆé™æ€æ„é€ å‡½æ•°æˆ–æ¨¡å—é¡¶å±‚ï¼‰
- è®¾ç½® `no_proxy=*` ç¡®ä¿æ‰€æœ‰åœ°å€ç›´è¿
- æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½éœ€è¦å¤„ç†

### 8.10 æœåŠ¡ç«¯æ•°æ®ç¼“å­˜

SuperDataServer.exe ä¼šä¸ºæ¯ä¸ªå®¢æˆ·ç«¯ç»´æŠ¤ç‹¬ç«‹çš„æ•°æ®ç¼“å­˜ï¼š

```pseudocode
class Server:
    // æŒ‰å®¢æˆ·ç«¯IDç´¢å¼•çš„æ•°æ®ç¼“å­˜
    clientDataCache = Map<clientId, FixtureList>
    
    function OnFixtureFullSync(clientId, fixtures):
        // å®Œå…¨æ›¿æ¢è¯¥å®¢æˆ·ç«¯çš„ç¼“å­˜
        clientDataCache[clientId] = fixtures
        UpdateClientFixtureCount(clientId, fixtures.length)
    
    function OnFixtureUpdate(clientId, uuid, changes):
        // æ›´æ–°ç¼“å­˜ä¸­çš„å•ä¸ªç¯å…·
        fixture = clientDataCache[clientId].find(uuid)
        fixture.applyChanges(changes)
        // å¹¿æ’­ç»™å…¶ä»–å®¢æˆ·ç«¯
        BroadcastToOthers(clientId, FixtureUpdate, {uuid, changes})
    
    function HandleFixtureListRequest(requesterId, sourceClientId):
        // è¿”å›æŒ‡å®šå®¢æˆ·ç«¯çš„ç¼“å­˜æ•°æ®
        fixtures = clientDataCache[sourceClientId]
        SendTo(requesterId, FixtureListResponse, {
            sourceClientId: sourceClientId,
            fixtures: fixtures,
            totalCount: fixtures.length
        })
    
    function OnClientDisconnect(clientId):
        // æ¸…é™¤è¯¥å®¢æˆ·ç«¯çš„ç¼“å­˜
        clientDataCache.remove(clientId)
        // å¹¿æ’­å®¢æˆ·ç«¯ç¦»å¼€
        BroadcastToAll(ClientLeft, {clientId})
        // æ£€æŸ¥æ˜¯å¦éœ€è¦é€€å‡º
        if clientDataCache.isEmpty():
            ExitProcess()
```

---

## 9. å®‰å…¨è€ƒè™‘

### 9.1 å½“å‰é™åˆ¶

å½“å‰ç‰ˆæœ¬ï¼ˆv1.0ï¼‰ä¸åŒ…å«åŠ å¯†ï¼Œä»…é€‚ç”¨äºï¼š
- æœ¬åœ°ç½‘ç»œç¯å¢ƒ
- å—ä¿¡ä»»çš„å†…ç½‘ç¯å¢ƒ

### 9.2 æœªæ¥è®¡åˆ’

åç»­ç‰ˆæœ¬å¯èƒ½æ·»åŠ ï¼š
- TLS åŠ å¯†ä¼ è¾“
- ä»¤ç‰Œè®¤è¯æœºåˆ¶
- æƒé™æ§åˆ¶ç³»ç»Ÿ

---

## 10. æ•…éšœæ’é™¤

### 10.1 æœåŠ¡æ— æ³•å¯åŠ¨

#### 10.1.1 SuperData Server æœªå®‰è£…

å¦‚æœå®¢æˆ·ç«¯æç¤º"SuperData Server æœªå®‰è£…"ï¼š

1. **ä¸‹è½½å®‰è£…åŒ…**ï¼šhttps://yunsio.com/superdata/download
2. **è¿è¡Œå®‰è£…ç¨‹åº**ï¼š`SuperDataSetup.exe`
3. **éªŒè¯å®‰è£…**ï¼š
```powershell
reg query "HKLM\SOFTWARE\Yunsio\SuperData" /v ExePath
```

#### 10.1.2 æ³¨å†Œè¡¨è·¯å¾„ä¸æ­£ç¡®

æ‰‹åŠ¨æ£€æŸ¥æ³¨å†Œè¡¨ï¼š
```powershell
# æ£€æŸ¥æ³¨å†Œè¡¨
reg query "HKLM\SOFTWARE\Yunsio\SuperData"

# å¦‚æœéœ€è¦æ‰‹åŠ¨ä¿®å¤ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰
reg add "HKLM\SOFTWARE\Yunsio\SuperData" /v ExePath /t REG_SZ /d "C:\Program Files\Yunsio\SuperData\SuperDataServer.exe" /f
```

#### 10.1.3 ç«¯å£è¢«å ç”¨

æ£€æŸ¥ TCP 5966 ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š
```powershell
netstat -ano | findstr :5966
```

å¦‚æœè¢«å ç”¨ï¼Œç»“æŸå ç”¨è¿›ç¨‹æˆ–ç­‰å¾…å…¶é‡Šæ”¾ã€‚

#### 10.1.4 é˜²ç—…æ¯’è½¯ä»¶é˜»æ­¢

æŸäº›é˜²ç—…æ¯’è½¯ä»¶å¯èƒ½é˜»æ­¢å¯åŠ¨å¤–éƒ¨ exeï¼Œå°è¯•æ·»åŠ ä¿¡ä»»æˆ–ä¸´æ—¶ç¦ç”¨ã€‚

### 10.2 è¿æ¥å»ºç«‹å¤±è´¥

#### 10.2.1 æœåŠ¡æœªè¿è¡Œ

ç¡®è®¤ SuperDataServer.exe æ˜¯å¦æ­£åœ¨è¿è¡Œï¼š
```powershell
tasklist | findstr SuperDataServer
```

#### 10.2.2 é˜²ç«å¢™é˜»æ­¢

å¦‚æœéœ€è¦è¿œç¨‹è¿æ¥ï¼ˆé localhostï¼‰ï¼Œç¡®ä¿é˜²ç«å¢™å…è®¸ TCP 5966ï¼š
```powershell
# ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
netsh advfirewall firewall add rule name="SuperData TCP" dir=in action=allow protocol=TCP localport=5966
```

### 10.3 æ•°æ®åŒæ­¥é—®é¢˜

#### 10.3.1 åæ ‡ä¸æ­£ç¡®

ç¡®ä¿å„ç«¯æ­£ç¡®å®ç°äº†åæ ‡ç³»è½¬æ¢ï¼š
- æ£€æŸ¥è½¬æ¢æ–¹å‘æ˜¯å¦æ­£ç¡®ï¼ˆå¯¼å…¥/å¯¼å‡ºï¼‰
- æ£€æŸ¥å•ä½æ˜¯å¦æ­£ç¡®è½¬æ¢ï¼ˆUEä½¿ç”¨å˜ç±³ï¼‰

#### 10.3.2 JSON è§£æé”™è¯¯

- ç¡®ä¿ JSON ä½¿ç”¨ UTF-8 ç¼–ç 
- æ£€æŸ¥ç‰¹æ®Šå­—ç¬¦æ˜¯å¦æ­£ç¡®è½¬ä¹‰

### 10.4 æ•°æ®æ¥æ”¶å»¶è¿Ÿï¼ˆå¸¸è§é—®é¢˜ï¼‰

#### 10.4.1 ç—‡çŠ¶

- è¿æ¥æˆåŠŸï¼Œä½†ç­‰å¾…å¾ˆé•¿æ—¶é—´ï¼ˆæ•°ç§’ç”šè‡³æ•°åˆ†é’Ÿï¼‰æ‰æ”¶åˆ°æ•°æ®
- åªæ”¶åˆ°éƒ¨åˆ†å“åº”ï¼Œå…¶ä»–å“åº”ä¸¢å¤±
- æ•°æ®å¶å°”æ­£å¸¸ï¼Œå¶å°”ä¸¢å¤±

#### 10.4.2 åŸå› ä¸è§£å†³

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| æ•°æ®å»¶è¿Ÿæ•°ç§’/åˆ†é’Ÿ | æœªç¦ç”¨ Nagle ç®—æ³• | è®¾ç½® `TCP_NODELAY = true`ï¼ˆè§ 8.8ï¼‰|
| åªæ”¶åˆ°ç¬¬ä¸€ä¸ªå“åº” | æœªå¤„ç† TCP ç²˜åŒ… | å¾ªç¯è§£æç¼“å†²åŒºï¼ˆè§ 8.7ï¼‰|
| è¿æ¥è¶…æ—¶/æ•°æ®å¼‚å¸¸ | è¢«ç³»ç»Ÿä»£ç†æ‹¦æˆª | ç¦ç”¨ç³»ç»Ÿä»£ç†ï¼ˆè§ 8.9ï¼‰|

#### 10.4.3 å¿«é€Ÿè¯Šæ–­

1. **æ£€æŸ¥å»¶è¿Ÿ**ï¼šå‘é€è¯·æ±‚åï¼Œè®°å½•æ”¶åˆ°å“åº”çš„æ—¶é—´
   - < 100ms â†’ æ­£å¸¸
   - > 1s â†’ å¯èƒ½æœªè®¾ç½® TCP_NODELAY

2. **æ£€æŸ¥ä¸¢åŒ…**ï¼šè¿ç»­å‘é€å¤šä¸ªè¯·æ±‚ï¼Œæ£€æŸ¥å“åº”æ•°é‡
   - è¯·æ±‚æ•° = å“åº”æ•° â†’ æ­£å¸¸
   - è¯·æ±‚æ•° > å“åº”æ•° â†’ å¯èƒ½æœªå¤„ç†ç²˜åŒ…

### 10.5 ä»£ç†å¯¼è‡´çš„è¿æ¥é—®é¢˜

#### 10.5.1 ç—‡çŠ¶

- è¿æ¥è¶…æ—¶æˆ–è¿æ¥è¢«æ‹’ç»
- è¿æ¥æˆåŠŸä½†æ— æ³•æ”¶å‘æ•°æ®
- æ•°æ®åŒ…æ ¼å¼é”™è¯¯ï¼ˆä»£ç†ä¿®æ”¹äº†æ•°æ®ï¼‰

#### 10.5.2 åŸå› 

ç³»ç»Ÿä»£ç†ï¼ˆClashã€V2Ray ç­‰ï¼‰æ‹¦æˆªäº† localhost è¿æ¥ã€‚

#### 10.5.3 è§£å†³æ–¹æ¡ˆ

1. **ä»£ç å±‚é¢**ï¼šç¡®ä¿å¯åŠ¨æ—¶æ¸…é™¤ä»£ç†ç¯å¢ƒå˜é‡ï¼ˆè§ 8.9ï¼‰
2. **ç³»ç»Ÿå±‚é¢**ï¼šåœ¨ä»£ç†è½¯ä»¶ä¸­å°† `127.0.0.1` å’Œ `localhost` æ·»åŠ åˆ°ç»•è¿‡åˆ—è¡¨
3. **ä¸´æ—¶æµ‹è¯•**ï¼šå…³é—­ä»£ç†è½¯ä»¶åæµ‹è¯•

### 10.6 å®¢æˆ·ç«¯åˆ—è¡¨é—®é¢˜

#### 10.5.1 çœ‹ä¸åˆ°å…¶ä»–å®¢æˆ·ç«¯

- ç¡®è®¤å…¶ä»–å®¢æˆ·ç«¯å·²æˆåŠŸè¿æ¥ï¼ˆæ£€æŸ¥ ConnectAck.accepted = trueï¼‰
- ç¡®è®¤å…¶ä»–å®¢æˆ·ç«¯å·²å‘é€ FixtureFullSync
- æ£€æŸ¥æ˜¯å¦æ­£ç¡®å¤„ç† ClientJoined æ¶ˆæ¯

#### 10.5.2 å®¢æˆ·ç«¯ç¯å…·æ•°é‡ä¸º0

- å®¢æˆ·ç«¯è¿æ¥åéœ€è¦å‘é€ FixtureFullSync ä¸ŠæŠ¥è‡ªå·±çš„æ•°æ®
- å¦‚æœæœ¬åœ°æ²¡æœ‰ç¯å…·ï¼Œå‘é€ç©ºåˆ—è¡¨å³å¯

---

## 11. ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´ |
|------|------|------|
| 1.0 | 2025 | åˆå§‹ç‰ˆæœ¬ |
| 1.0.1 | 2025-11 | æ·»åŠ  TCP ç²˜åŒ…å¤„ç†è¯´æ˜ |
| 1.0.1 | 2025-11 | æ·»åŠ  TCP_NODELAY è¦æ±‚ |
| 1.0.1 | 2025-11 | æ ‡å‡†åæ ‡ç³»å•ä½æ”¹ä¸ºå˜ç±³ï¼ˆcmï¼‰|
| 1.0.2 | 2025-11 | ä¿®æ­£æ—‹è½¬è½¬æ¢å…¬å¼ï¼ˆæ‰‹æ€§é—®é¢˜ï¼‰|
| 1.0.3 | 2025-11 | æ·»åŠ  GrandMA2 åæ ‡è½¬æ¢å…¬å¼ |
| **2.0.0** | **2025-12-01** | **ğŸ‰ æ­£å¼å‘å¸ƒï¼šç¾¤èŠæ¶æ„** |
| 2.0.0 | 2025-12-01 | å¼•å…¥ç‹¬ç«‹æœåŠ¡è¿›ç¨‹ SuperDataServer.exe |
| 2.0.0 | 2025-12-01 | ç§»é™¤ UDP æœåŠ¡å‘ç°ï¼ˆ0x0001-0x0003ï¼‰|
| 2.0.0 | 2025-12-01 | ç§»é™¤ç±»å‹æ˜ å°„åŒ…ï¼ˆ0x0030-0x0032ï¼‰|
| 2.0.0 | 2025-12-01 | æ–°å¢ ClientJoined/ClientLeftï¼ˆ0x0014-0x0015ï¼‰|
| 2.0.0 | 2025-12-01 | æ–°å¢ FixtureFullSyncï¼ˆ0x0023ï¼‰|
| 2.0.0 | 2025-12-01 | ç®€åŒ–å®¢æˆ·ç«¯å®ç°ï¼Œåè®®å±‚ç»Ÿä¸€ç”± Server å¤„ç† |
| 2.0.0 | 2025-12-01 | ç³»ç»Ÿçº§å®‰è£…åŒ…ï¼ˆInno Setupï¼‰ï¼Œæ”¯æŒä¸­è‹±æ–‡ |
| 2.0.0 | 2025-12-01 | å®¢æˆ·ç«¯è‡ªåŠ¨å¯åŠ¨æœåŠ¡å™¨|
| 2.0.0 | 2025-12-01 | æä¾› 8 ç§è¯­è¨€å®¢æˆ·ç«¯ç¤ºä¾‹ï¼ˆPython/JS/TS/C#/C++/Rust/Java/Luaï¼‰|

---

## é™„å½• A: å¸¸é‡å®šä¹‰

```c
// åè®®å¸¸é‡
#define SUPERDATA_MAGIC         "SPDT"
#define SUPERDATA_VERSION       2
#define SUPERDATA_DATA_PORT     5966
#define SUPERDATA_HEARTBEAT_MS  3000
#define SUPERDATA_TIMEOUT_MS    10000
#define SUPERDATA_MAX_PACKET    65536

// å¹³å°ä»£ç 
#define PLATFORM_UNKNOWN        0
#define PLATFORM_UNITY          1
#define PLATFORM_UNREAL         2
#define PLATFORM_VECTORWORKS    3
#define PLATFORM_GRANDMA        4
#define PLATFORM_CUSTOM         255

// æ•°æ®åŒ…ç±»å‹ - è¿æ¥ç®¡ç†
#define PKT_CONNECT             0x0010
#define PKT_CONNECT_ACK         0x0011
#define PKT_DISCONNECT          0x0012
#define PKT_HEARTBEAT           0x0013

// æ•°æ®åŒ…ç±»å‹ - å®¢æˆ·ç«¯ç®¡ç†
#define PKT_CLIENT_JOINED       0x0014
#define PKT_CLIENT_LEFT         0x0015

// æ•°æ®åŒ…ç±»å‹ - æ•°æ®åŒæ­¥
#define PKT_FIXTURE_LIST_REQ    0x0020
#define PKT_FIXTURE_LIST_RESP   0x0021
#define PKT_FIXTURE_UPDATE      0x0022
#define PKT_FIXTURE_FULL_SYNC   0x0023
#define PKT_FIXTURE_DELETE      0x0024

// æ•°æ®åŒ…ç±»å‹ - é”™è¯¯
#define PKT_ERROR               0xFF00
```

---

## é™„å½• B: JSON Schema

### B.1 Fixture Schema

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": ["uuid", "name", "fixtureType", "universe", "startAddress", "fixtureID", "position", "rotation"],
    "properties": {
        "uuid": { "type": "string", "description": "å®¢æˆ·ç«¯ç”Ÿæˆçš„UUID" },
        "name": { "type": "string" },
        "fixtureType": { "type": "string", "description": "å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„ç±»å‹å" },
        "universe": { "type": "integer", "minimum": 1, "maximum": 256 },
        "startAddress": { "type": "integer", "minimum": 1, "maximum": 512 },
        "fixtureID": { "type": "integer", "minimum": 1 },
        "position": { "type": "array", "items": { "type": "number" }, "minItems": 3, "maxItems": 3, "description": "æ ‡å‡†åæ ‡ç³»ï¼Œå•ä½cm" },
        "rotation": { "type": "array", "items": { "type": "number" }, "minItems": 3, "maxItems": 3, "description": "æ¬§æ‹‰è§’ï¼Œå•ä½åº¦" },
        "scale": { "type": "array", "items": { "type": "number" }, "minItems": 3, "maxItems": 3 },
        "channelSpan": { "type": "integer" },
        "customProperties": { "type": "object" }
    }
}
```

### B.2 ClientInfo Schema

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": ["clientId", "clientName", "platform"],
    "properties": {
        "clientId": { "type": "string", "description": "å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ç¬¦(UUID)" },
        "clientName": { "type": "string", "description": "å®¢æˆ·ç«¯æ˜¾ç¤ºåç§°" },
        "platform": { "type": "integer", "description": "å¹³å°ä»£ç " },
        "fixtureCount": { "type": "integer", "description": "å½“å‰ç¯å…·æ•°é‡" }
    }
}
```

---

**æ–‡æ¡£ç»“æŸ**

---

## è®¸å¯è¯

[![License: CC BY-NC 4.0](https://img.shields.io/badge/License-CC%20BY--NC%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by-nc/4.0/)

æœ¬é¡¹ç›®é‡‡ç”¨ [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/)ï¼ˆçŸ¥è¯†å…±äº«-ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…ï¼‰è®¸å¯åè®®ã€‚

- âœ… å¯è‡ªç”±å…±äº«ã€ä¿®æ”¹ã€æ¼”ç»
- âœ… éœ€ä¿ç•™ç½²å
- âŒ ç¦æ­¢å•†ä¸šä½¿ç”¨

è¯¦ç»†æ¡æ¬¾è¯·å‚é˜… [LICENSE](LICENSE)ï¼ˆ[English](LICENSE_EN)ï¼‰| å•†ä¸šæˆæƒè¯·è”ç³» [Yunsio](https://yunsio.com)

---

<p align="center">
  <b>SuperData Protocol v2.0.0</b><br>
  è·¨å¹³å°èˆå°ç¯å…·æ•°æ®åŒæ­¥åè®®<br><br>
  Â© 2025 Yunsio SuperStage Team. All rights reserved.
</p>

